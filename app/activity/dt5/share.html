<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <title>炫图神器</title>
    <link rel="stylesheet" href="../../../lib/confirm/confirm.css" />
    <link rel="stylesheet" href="../css/reset.css" />
    <script src="../../../lib/sitestat/baidu.js"></script>
	<script src="../../../lib/mobile/mobile.js"></script>
    <script src="../../../lib/jquery/js/jquery.min.js"></script>
    <script src="../../../lib/common/common.js"></script>
    <script src="../../../lib/confirm/confirm.js"></script>
    <script src="../../../lib/device/device.js"></script>
    <script src="../../report/report.js?d=1280977331177"></script>
    <script src="../../api/api.js?d=1280977331177"></script>
    <style type="text/css">
        @media screen and (min-width: 1367px) {
            html,body{height:100%;max-width: 640px;margin: 0 auto;background-color: #282828;}
            p{
                text-align: center;
                font-family: "Microsoft YaHei", Arial, "Helvetica";
                font-size: 28px;
                color: white;
            }
        }
        @media screen and (min-width: 769px) and (max-width: 1366px) {
            html,body{height:100%;max-width: 400px;margin: 0 auto;background-color: #282828;}
            p{
                text-align: center;
                font-family: "Microsoft YaHei", Arial, "Helvetica";
                font-size: 18px;
                color: white;
            }
        }
        @media screen and (max-width: 768px) {
            html,body{height:100%;max-width: 768px;margin: 0 auto;background-color: #282828;}
            p{
                text-align: center;
                font-family: "Microsoft YaHei", Arial, "Helvetica";
                font-size: 18px;
                color: white;
            }
        }
        #wrap {width: 100%; height: 100%; display: -webkit-box;  -webkit-box-orient: vertical;  overflow: hidden;}
        #wrap .use{margin: 10% auto;width: 80%; border-radius: 10px;border: 2px solid white;display: block}
        button{
            margin: 10% auto;
            width: 80%;
            display: block;
            background: transparent;
        }
        button img{width: 100%;}
        #canvas1{
            display: none;
        }
    </style>
</head>
<body>
    <div id="wrap">
        <img class="use"/>
        <canvas id="canvas1" ></canvas>
        <p>鼠标右键可保存图片</p>
        <button id="btn" ><img src="imges/btn_green2.png" alt=""/></button>
    </div>
<script>
        var sUserAgent = navigator.userAgent.toLowerCase();
        var bIsIphoneOs = sUserAgent.match(/iphone os/i) == "iphone os";
        var bIsIpad = sUserAgent.match(/ipad/i) == "ipad";
        var bIsAndroid = sUserAgent.match(/android/i) == "android";
        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURIComponent(r[2]);
            return null;
        }
        var name = getQueryString('name');
        var text = decodeURI(decodeURI(getQueryString('text')));
        $('#wrap').css({"background":'url(pc/picture/'+name+'_bg.jpg)no-repeat',"background-size":"cover"})
        function getCanvas(id){
            return document.getElementById(id);
        }
        var ctx=document.getElementById('canvas1');
        var mainCtx = ctx.getContext('2d');
        var activity_text;
        var activity_top;
        var activity_left;
        if (name == 'yxlmzp') {
            title = "不知道腾讯游戏的待遇怎么样";
            content = "英雄联盟官方招聘信息";
            ctx.width=800;
            ctx.height=533;
            activity_left = 212;
            activity_top = 122;
            mainCtx.font = "13px";
            mainCtx.fillStyle = "#666";
            mainCtx.textAlign="left";
            activity1_text = '';
        }else if(name == 'mshxcz'){
            title = "魔兽核心橙装，终于得到了！";
            content = "魔兽世界火法核心橙";
            ctx.width=768;
            ctx.height=583;
            activity_left = 148;
            activity_left2 = 603;
            activity_left3 = 295;
            activity_top = 52;
            activity_top2 = 136;
            activity_top3 = 132;
            mainCtx.font = "12px 微软雅黑";
            mainCtx.fillStyle = "#ffef09";
            mainCtx.textAlign="center";
            activity1_text = '';
        }else if(name == 'qb'){
            var date = new Date();
            var year = date.getFullYear();
            var month = date.getMonth()+1;
            var day = date.getDate();
            var hour = date.getHours();
            var minute = date.getMinutes();
            var Nowtime= year+'年'+month+'月'+day+'日 '+ hour+'时'+minute+'分';
            title = "随随便便冲了点Q币";
            content = "Q币充值信息";
            ctx.width=799;
            ctx.height=426;
            activity_left = 255;
            activity_left2 = 384;
            activity_left3 = 381;
            activity_top = 159;
            activity_top2 = 247;
            activity_top3 = 229;
            mainCtx.font = "13px 微软雅黑";
            mainCtx.fillStyle = "#b42727";
            mainCtx.textAlign="left";
            activity1_text = '';
        }else if(name == 'wzryrmb'){
            title = "王者荣耀";
            content = "感觉冲了这么多点券到现在玩不动了呢。";
            ctx.width=1334;
            ctx.height=750;
            activity_left = 133;
            activity_top = 32;
            mainCtx.font = "19px 微软雅黑";
            mainCtx.fillStyle = "#e1f4ff";
            mainCtx.textAlign="left";
            activity1_text = '';
        }
        mainCtx.clearRect(0,0,2000,2000);
        var starSelectImg = 'pc/picture/'+name+'_use.jpg';
        var starImg = new Image();
        starImg.src=starSelectImg;
        starImg.onload=function(){
            mainCtx.drawImage(starImg,0,0);
            if(name == 'qb'){
                var text2 = decodeURI(decodeURI(getQueryString('text2')));
                mainCtx.fillText(text+activity1_text,activity_left,activity_top);
                mainCtx.fillStyle = "#e7112a";
                mainCtx.fillText(text2+activity1_text,activity_left3,activity_top3);
                mainCtx.fillStyle = "#474747";
                mainCtx.fillText('Q币'+activity1_text,activity_left3+text2.length*8+2,activity_top3);
                mainCtx.fillStyle = "#474747";
                mainCtx.fillText(Nowtime+activity1_text,activity_left2,activity_top2);
            }else if(name == 'mshxcz'){
                mainCtx.fillText(text+activity1_text,activity_left,activity_top);
                mainCtx.font = "bold 15px 微软雅黑";
                mainCtx.fillStyle = "#fff";
                mainCtx.fillText(text+activity1_text,activity_left2,activity_top2);
                mainCtx.fillStyle = "white";
                mainCtx.font = "normal 14px 微软雅黑";
                mainCtx.textAlign="left";
                mainCtx.fillText(text+activity1_text,activity_left3,activity_top3);
            }else{
                mainCtx.fillText(text+activity1_text,activity_left,activity_top);
            }
            mainCtx.save();
            var canvasData = getCanvas('canvas1').toDataURL('image/jpg');
            $(".use").attr("src",canvasData);
        };
		var scheme = {
            'ios': encodeURIComponent('gamecircle://openActivity'),
            'android': encodeURIComponent('gamecircle://ymcx.gamecircle?act=hotActive')
		};
        // 立即打开的按钮
        document.getElementById('btn').addEventListener('click', function() {
            if (bIsIphoneOs || bIsIpad) {
                window.location.href = 'http://www.youmengchuangxiang.com/app/install/index.html?scheme=' + scheme['ios'];
            } else if (bIsAndroid) {
                window.location.href = 'http://www.youmengchuangxiang.com/app/install/index.html?scheme=' + scheme['android'];
            } else {
                window.location.href = 'http://www.youmengchuangxiang.com/app/install/index.html';
            }
		}, false);
    </script>
</body>
</html>
